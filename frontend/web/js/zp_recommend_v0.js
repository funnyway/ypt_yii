(function(){var oLink=document.createElement("link");oLink.type="text/css";oLink.href="http://static.58.com/ui7/job/hire/zp_recommend.css";oLink.rel="stylesheet";document.getElementsByTagName("head")[0].appendChild(oLink)})();var ZPRECOMCONFIG_VER=ZPRECOMCONFIG_VER||{};var ZPRECOMCONFIG_URL="http://rec.58.com/recommend";ZPRECOMCONFIG_VER.VerticalInit=function(){ZPRECOMCONFIGVER.NowPage=0;var control=ZP_RECOMMEN.controls;function processingLogic(){var pageSize=ZPRECOMCONFIGVER.pageSize,nowPage=ZPRECOMCONFIGVER.NowPage,nowData=[],startNum=nowPage*pageSize,json=ZPRECOMCONFIGVER.JSONDATA,fillDataHtml="",totalHtml="",htmlTemplate='<li rs_tj_tag=\'{$tarckstr}\'><div class="zp-recommedver-content"><p><a rs_tj_location="rs_title" target="_blank" href="{$url}">{$title}</a></p><p class="info"><span>{$salary}</span><span>{$local}</span></p><p>{$itemreason}</p></div></li>';for(var i=startNum,len=json.data.length;i<len&&i<startNum+pageSize;i++){var data=json.data[i];if(!data.isDeal){data.tarckstr=control.getTrackStr(data,i%pageSize,ZPRECOMCONFIGVER,ZPRECOMCONFIGVER.NowPage);data.isDeal=true}nowData.push(data)}control.trackShowLog(nowData,ZPRECOMCONFIGVER,ZPRECOMCONFIGVER.NowPage);for(var j=0;j<nowData.length;j++){fillDataHtml=ZP_RECOMMEN.unit.fillData(htmlTemplate,nowData[j]);totalHtml+=fillDataHtml}return totalHtml}function bindChangeEvent(){$("#zp_recommedver").find(".zprechange_ver").click(function(event){ZPRECOMCONFIGVER.NowPage++;if(ZPRECOMCONFIGVER.NowPage==ZPRECOMCONFIGVER.pageCount){ZPRECOMCONFIGVER.NowPage=0}var innerhtml=processingLogic();$(".zp-recommedver-con").html(innerhtml);$(".zp-recommedver-content").last().addClass("last");control.bindTrackEvent("#zp_recommedver")})}function bindHoverEvent(){$(".zp-recommedver-con").delegate("li","hover",function(event){if($(this).attr("ison")=="0"){$(this).css("backgroundColor","#ffffff");$(this).attr("ison","1")}else{$(this).css("backgroundColor","#f7f7f7");$(this).attr("ison","0")}})}ZPRECOMCONFIGVER.numlimit=ZPRECOMCONFIGVER.pageSize*ZPRECOMCONFIGVER.pageCount;$.ajax({url:ZPRECOMCONFIG_URL,type:"get",dataType:"jsonp",data:ZPRECOMCONFIGVER,complete:function(xhr,textStatus){},success:function(json,textStatus,xhr){ZPRECOMCONFIGVER.JSONDATA=json;var totalCount=json.data.length;var pageSize=ZPRECOMCONFIGVER.pageSize;if(totalCount<ZPRECOMCONFIGVER.numlimit){if(totalCount<pageSize){$("#zp_recommedver").hide()}else{ZPRECOMCONFIGVER.pageCount=Math.floor(totalCount/pageSize)}}var html=processingLogic();var $objVertical=$("#zp_recommedver");$objVertical.addClass("zp_recommedver");$objVertical.append('<p class="zp-recommedver-title"><span class="zprechange_ver">换一换</span>申请该职位的人还申请了</p><ul class="zp-recommedver-con"></ul>');$objVertical.find(".zp-recommedver-con").append(html);$(".zp-recommedver-content").last().addClass("last");if(ZPRECOMCONFIGVER.pageCount>1){bindChangeEvent()}else{$(".zprechange_ver").hide()}bindHoverEvent();control.bindTrackEvent("#zp_recommedver")},error:function(xhr,textStatus,errorThrown){}})};$(function(){ZP_RECOMMEN.views.init();if(ZPRECOMCONFIG.pageid==17){ZPRECOMCONFIG_VER.VerticalInit()}});var ZP_RECOMMEN={globalVar:{HtmlTemplate:'<div class="head"><p class="title">您可能感兴趣的简历</p><i class="tipnew"></i><div class="headr"><a class="zprechange" href="javascript:;">换一换</a></div></div><ul id="zp-recontent" class="zp-recontent zpreclear"></ul>',JSONDATA:{},NowPage:0},unit:{fillData:function(str,json){return str.replace(/\{\$\w+\}/g,function(s){var name=s.substring(2,s.length-1);return json[name]})},json2url:function(json){json=json||{};var arr=[];for(var i in json){arr.push(i+"="+json[i])}return arr.join("&")}},models:{loadData:function(fnsucc){ZPRECOMCONFIG.numlimit=ZPRECOMCONFIG.pageSize*ZPRECOMCONFIG.pageCount;$.ajax({url:ZPRECOMCONFIG_URL,type:"get",dataType:"jsonp",data:ZPRECOMCONFIG,complete:function(xhr,textStatus){},success:function(data,textStatus,xhr){if(data.data){window.console&&console.log(data.data.length);fnsucc&&fnsucc(data)}},error:function(xhr,textStatus,errorThrown){}})}},controls:{getHtml:function(list){var totalHtml="";if(ZPRECOMCONFIG.businessentitytype==1){var htmlTemplate='<li class="list" rs_tj_tag=\'{$tarckstr}\'><div class="eventEle"><div class="cl zpreclear"><p class="tle fl"><a rs_tj_location="rs_title" target="_blank" href="{$url}">{$title}</a>{$isvalidamobile}{$pic}</p><p class="addr fr">{$local}</p></div><div class="cr zpreclear"><p class="tag fl"><span>{$truename}</span><span>{$sex}</span><span>{$age}</span><span>{$workyears}</span>{$nowposition}</p><p class="date fr">{$date}</p></div></div><div class="active"><div class="zp-rebox"><div class="cl zpreclear"><p class="tle fl"><a rs_tj_location="rs_title" target="_blank" href="{$url}">{$title}</a>{$isvalidamobile}{$pic}</p><p class="addr fr">{$local}</p></div><div class="cr zpreclear"><p class="tag fl"><span>{$truename}</span><span>{$sex}</span><span>{$age}</span><span>{$workyears}</span>{$nowposition}</p><p class="date fr">{$date}</p></div></div><div class="recommen-info"><ul class="re-ly zpreclear"><li class="re-title">推荐理由：</li><li class="re-con">{$itemreason}</li></ul>{$light}</div></div></li>'}else{var htmlTemplate='<li class="list" rs_tj_tag=\'{$tarckstr}\'><div class="eventEle"><div class="cl zpreclear"><p class="tle fl"><a rs_tj_location="rs_title" target="_blank" href="{$url}">{$title}</a></p><p class="salary fr">{$salary}</p></div><div class="cr zpreclear"><p class="tag fl"><span>{$companyname}</span><span>{$local}</span></p><p class="date fr">{$date}</p></div></div><div class="active"><div class="zp-rebox" ><div class="cl zpreclear"><p class="tle fl"><a rs_tj_location="rs_title" target="_blank" href="{$url}">{$title}</a></p><p class="salary fr">{$salary}</p></div><div class="cr zpreclear"><p class="tag fl"><span>{$companyname}</span><span>{$local}</span></p><p class="date fr">{$date}</p></div></div><div class="recommen-info"><ul class="re-ly zpreclear" ><li class="re-title">推荐理由：</li><li class="re-con">{$itemreason}</li></ul>{$light}</div></div></li>'}var fillDataHtml="";for(var i=0,length=list.length;i<length;i++){var data=list[i],control=ZP_RECOMMEN.controls;if(ZPRECOMCONFIG.businessentitytype==1){if(!data.isDeal){if(data.isvalidamobile){data.isvalidamobile='<span class="phoneicon" title="该手机已认证"></span>'}else{data.isvalidamobile=""}if(data.pic){data.pic='<span class="timg">['+data.pic+"图]</span>"}else{data.pic=""}if(data.nowposition){data.nowposition="<span>现任"+data.nowposition+"</span>"}if(data.itemreasons.length>0){var itemreasonHtml="";for(var a=0;a<data.itemreasons.length;a++){itemreasonHtml+='<span class="itemreason">'+data.itemreasons[a]+"</span>"}data.itemreason=itemreasonHtml}else{data.itemreason="<p>"+data.itemreason+"</p>"}if(data.light&&data.light.length>0){var lhtml='<ul class="re-ly zpreclear"><li class="re-title">TA的亮点：</li>';var lightHtml="";for(var j=0,lightLength=data.light.length;j<lightLength;j++){lightHtml+="<span>"+data.light[j]+"</span>"}lhtml+='<li class="re-ld">'+lightHtml+"</li></ul>";data.light=lhtml}else if(data.introduce.length>0){data.light='<ul class="re-ly zpreclear"><li class="re-title">自我介绍：</li><li class="re-ld"><p>'+data.introduce+"</p></li></ul>"}else{data.light=""}data.tarckstr=control.getTrackStr(data,i,ZPRECOMCONFIG,ZP_RECOMMEN.globalVar.NowPage);data.isDeal=true}}else{if(!data.isDeal){if(data.light&&data.light.length>0){var lightHtml="";for(var j=0,lightLength=data.light.length;j<lightLength;j++){lightHtml+="<span>"+data.light[j]+"</span>"}data.light='<ul class="re-ly zpreclear"><li class="zwlight">'+lightHtml+"</li></ul>"}else if(data.introduce.length>0){data.light='<ul class="re-ly zpreclear"><li class="re-title">职位介绍：</li><li class="re-ld"><p>'+data.introduce+"</p></li></ul>"}else{data.light=""}if(data.itemreasons.length>0){var itemreasonHtml="";for(var a=0;a<data.itemreasons.length;a++){itemreasonHtml+='<span class="itemreason">'+data.itemreasons[a]+"</span>"}data.itemreason=itemreasonHtml}else{data.itemreason="<p>"+data.itemreason+"</p>"}data.tarckstr=control.getTrackStr(data,i,ZPRECOMCONFIG,ZP_RECOMMEN.globalVar.NowPage);data.isDeal=true}}fillDataHtml=ZP_RECOMMEN.unit.fillData(htmlTemplate,data);totalHtml+=fillDataHtml}return totalHtml},getTrackStr:function(data,i,jsonConfig,NowPage){var dataLog={};dataLog.iid=data.infoid;dataLog.itag=data.itag;dataLog.iseq=data.iseq;dataLog.iruid=data.iruid;dataLog.Ibiz=data.Ibiz;dataLog.iuid=data.iuid;dataLog.Iarea=jsonConfig.Iarea;dataLog.Icate=jsonConfig.dispcatid;dataLog.Ptag=jsonConfig.pageid+"-"+jsonConfig.regionid;dataLog.Ppn=NowPage+1;dataLog.Psn=i+1;return ZP_RECOMMEN.unit.json2url(dataLog)},trackShowLog:function(data,jsonConfig,NowPage){var dataLog={},str="";for(var i=0,len=data.length;i<len;i++){str+=","+ZP_RECOMMEN.controls.getTrackStr(data[i],i,jsonConfig,NowPage)}if(window.showLog){window.showLog(str.substring(1))}else{window.parent.showLog&&window.parent.showLog(str.substring(1))}},processingLogic:function(){var pageSize=ZPRECOMCONFIG.pageSize,nowPage=ZP_RECOMMEN.globalVar.NowPage,nowData=[],startNum=nowPage*pageSize,json=ZP_RECOMMEN.globalVar.JSONDATA;for(var i=startNum,len=json.data.length;i<len&&i<startNum+pageSize;i++){nowData.push(json.data[i])}ZP_RECOMMEN.controls.trackShowLog(nowData,ZPRECOMCONFIG,ZP_RECOMMEN.globalVar.NowPage);return ZP_RECOMMEN.controls.getHtml(nowData)},bindChangeEvent:function(){$("#zp_recommend").find(".zprechange").click(function(event){var globalvar=ZP_RECOMMEN.globalVar,control=ZP_RECOMMEN.controls;globalvar.NowPage++;if(globalvar.NowPage==ZPRECOMCONFIG.pageCount){globalvar.NowPage=0}var innerhtml=control.processingLogic();$("#zp-recontent").html(innerhtml);ZP_RECOMMEN.views.dealWidth();control.bindTrackEvent("#zp_recommend")})},bindTrackEvent:function(selector){$(selector).find("[rs_tj_tag]").delegate("a","click",function(event){var rs_tj_location=$(this).attr("rs_tj_location"),rs_tj_tag=$(event.liveFired||event.delegateTarget).attr("rs_tj_tag");if(rs_tj_location){var reui="";if(ZPRECOMCONFIG.reui){reui="&reui="+ZPRECOMCONFIG.reui}if(window.clickLog){window.clickLog("from="+rs_tj_location+"&"+rs_tj_tag+reui)}else{window.parent.clickLog&&window.parent.clickLog("from="+rs_tj_location+"&"+rs_tj_tag+reui)}}})}},views:{init:function(){ZP_RECOMMEN.models.loadData(function(json){ZP_RECOMMEN.globalVar.JSONDATA=json;var totalCount=json.data.length,control=ZP_RECOMMEN.controls;var pageSize=ZPRECOMCONFIG.pageSize;if(totalCount<ZPRECOMCONFIG.numlimit){if(totalCount<pageSize){$("#zp_recommend").hide()}else{ZPRECOMCONFIG.pageCount=Math.floor(totalCount/pageSize)}}var html=control.processingLogic();ZP_RECOMMEN.views.dealHtml(html);if(ZPRECOMCONFIG.pageCount>1){control.bindChangeEvent()}else{$(".zprechange").hide()}control.bindTrackEvent("#zp_recommend")})},dealHtml:function(html){$("#zp_recommend").addClass("zp-recommen");$(ZP_RECOMMEN.globalVar.HtmlTemplate).appendTo("#zp_recommend");$(html).appendTo("#zp-recontent");if(ZPRECOMCONFIG.businessentitytype==2){$("#zp_recommend").find(".title").html("您可能感兴趣的职位")}$("#zp_recommend").delegate(".zp-rebox,.eventEle","hover",function(event){var $this=$(this).parent();if(!$this.hasClass("list")){$this=$(this).parent().parent()}if($this.css("zIndex")==0||$this.css("zIndex")=="auto"){$this.css("zIndex",1).find(".active").show()}else{$this.css("zIndex",0).find(".active").hide()}});ZP_RECOMMEN.views.dealWidth()},dealWidth:function(){$("#zp_recommend").css("width",ZPRECOMMENSIZE);$("#zp_recommend").find(".zp-rebox,.list,.active,.re-ly").css("width",(ZPRECOMMENSIZE-3)/2);$("#zp_recommend").find(".re-ld,.re-con").css("width",(ZPRECOMMENSIZE-3)/2-100);if(ZPRECOMCONFIG.pageid==9){$(".list .fr").hide()}}}};