(function(e,t){var i=navigator.userAgent.toUpperCase().match(/MSIE\s[678]/)===null?false:true,n=e.____json4fe?e.____json4fe.catentry||[]:[],a=!!n[0]?n[0].dispid:"",o=!!n[1]?n[1].dispid:"",r=/^((\^?)|(\??))([0-9a-zA-Z_-]+)/i,s=function(e){return typeof e!=="undefined"?parseFloat(e).toFixed(0):"-"},f=false,l=function(){},u=function(e,t){return Array.prototype.map?[].map.call(e,t):function(e,t){var i,n,a;if(this==null){throw new TypeError(" this is null or not defined")}var o=Object(this);var r=o.length>>>0;if(typeof e!=="function"){throw new TypeError(e+" is not a function")}if(arguments.length>1){i=t}n=new Array(r);a=0;while(a<r){var s,f;if(a in o){s=o[a];f=e.call(i,s,a,o);n[a]=f}a++}return n}.call(e,t)},p=function(e,t,i){return Array.prototype.indexOf?[].indexOf.call(e,t,i):function(e,t){var i;if(this==null){throw new TypeError('"this" is null or not defined')}var n=Object(this);var a=n.length>>>0;if(a===0){return-1}var o=+t||0;if(Math.abs(o)===Infinity){o=0}if(o>=a){return-1}i=Math.max(o>=0?o:a-Math.abs(o),0);while(i<a){var r;if(i in n&&n[i]===e){return i}i++}return-1}.call(e,t,i)};var d={limit:50,type:"text"};var g={input:{click:10,paste:5,focus:5,blur:5,input:0,mouseover:1,mouseout:1},button:{mousedown:-1,mouseup:-1},editor:{click:10,paste:5,focus:5,blur:5,input:0,mouseover:1,mouseout:1}};var h={name:"__post_gsxw",form:"aspnetForm",input:["Title"],button:["^fabu"],editor:["editor"]};var c={type:"",id:"",instance:null,element:null,defaults:{type:"htmleditor"},getEditorType:function(e,t){var i=this,n=i.defaults.type;if(typeof i.typeCateMap[e]==="string"){n=i.typeCateMap[e]}else if(typeof i.typeCateMap[e]==="object"){if(typeof i.typeCateMap[e][t]==="string"){n=i.typeCateMap[e][t]}else if(typeof i.typeCateMap[e]["*"]==="string"){n=i.typeCateMap[e]["*"]}else{n=i.defaults.type}}else{n=i.defaults.type}return n},getEditorElement:function(){var e=this;if(e.type==="baidueditor"){try{e.instance=baidu.editor.instants["ueditorInstant0"];return e.instance.document}catch(t){return null}}else if(e.type==="htmleditor"){e.id="div_htmleditor";return $(e.id).find(".editor")[0]}else{return null}},bindEditorEvents:function(e,t){var i=this,n=g[e.type],r=t.loggerHandler,s=e.isDynamic,f=null;i.type=i.getEditorType(a,o);i.element=i.getEditorElement();function l(n,a,o){var s=0;i.instance.addListener(n,function(f,l){var u=arguments.callee;r.call(o,l,e,a,t);if(++s===a){i.instance.removeListener(n,u)}})}function u(i,n,a){var o=0;$(a)[s?"live":"bind"](i,function(f){var l=arguments.callee;r.call(this,f,e,n,t);if(++o===n){$(a)[s?"die":"unbind"](i,l)}})}if(i.instance&&typeof i.instance.ready==="function"){i.instance.ready(function(){i.element=i.instance.document.documentElement;for(var e in n){logNum=n[e]||0;if("focus,blur".indexOf(e)>-1){l(e,logNum,i.element)}else{u(e,logNum,i.element)}}})}else{t.bindEvents(e)}},typeCateMap:{1:{8:"baidueditor",10:"baidueditor",12:"baidueditor"},4:{29:"none",30:"baidueditor",240:"baidueditor"},5:"baidueditor",832:{252:"baidueditor"},8640:{8645:"none",8658:"none"},9224:{"*":"baidueditor",13889:"none"},13941:"htmleditor"}};var m=function(){var t;this.loggers={};this.pageInfo={};this.logSeq=[];this.logStr="";this.lists=$.extend({},h,e.__gsxw_conf);t=$("#"+this.lists.form);this.$form=t.size()>0?t:$("body");this.submitBtns=[];this.init()};m.prototype={constructor:m,init:function(){var e=this;e.initLoggers();$.each(e.submitBtns,function(t,i){i.bind("mouseup",function(){var t=$(this),i=$("[name="+e.lists.name+"]").size()===0?$('<input type="hidden"/>'):$("[name="+e.lists.name+"]"),n=$("#xxzl_lsid").val()||"",a=e.logPageInfo();e.logStr=e.logSeq.join(";");i.attr("name",e.lists.name);i.val(e.logStr+";"+a.toString()+";"+n);i.appendTo(e.$form)})})},initLoggers:function(){var e=this,t="",i="",n=false;e.initPageInfo();for(var a in e.lists){if($.isArray(e.lists[a])){for(var o=0,r=e.lists[a].length;o<r;o++){t=e.lists[a][o];e.getLogger(t,a)}}}},initPageInfo:function(){var t=this;t.pageInfo.largeCate=a||"-";t.pageInfo.smallCate=o||"-";t.pageInfo.historyLength=e.history.length;t.pageInfo.loadTime=+new Date;t.pageInfo.width=$(document).width();t.pageInfo.height=$(document).height()},logPageInfo:function(){var e=this,t=[];e.pageInfo.submitTime=+new Date;t.push("page");t.push(e.pageInfo.largeCate);t.push(e.pageInfo.smallCate);t.push(e.pageInfo.width);t.push(e.pageInfo.height);t.push(e.pageInfo.loadTime);t.push(e.pageInfo.submitTime);t.push(e.pageInfo.historyLength);return t},getLogger:function(e,i){var n=this,s,f,l,u=c.getEditorType(a,o),p={};if(!r.exec(e))return t;f=r.exec(e)[4];l=!!r.exec(e)[3];if(!!r.exec(e)[2])n.submitBtns.push($("#"+f));if(i!=="editor"){s=$("#"+f);if(!l&&s.size()===0)return t}p.type=i;p.id=f;p.isDynamic=l;n.loggers[f]=p;if(i==="editor"){c.bindEditorEvents(p,n)}else{n.bindEvents(p)}return p},bindEvents:function(e){var t=this,i=null,n=g[e.type],a=e.isDynamic,o=t.loggerHandler,r=function(n,r){var s=0;i[a?"live":"bind"](n,function(f){var l=arguments.callee;o.call(this,f,e,r,t);if(++s===r){i[a?"die":"unbind"](n,l)}})};if(e.type==="editor"){i=$("#"+c.id+" .editor");if(i.size()===0)i=$("#"+e.id)}else{i=$("#"+e.id)}for(var s in n){logNum=n[s]||0;r(s,logNum)}},formatLog:function(e){var t=[];t.push(e.id);t.push(e.type);t.push(e.eventType);t.push(e.timeStamp);t.push(s(e.pasteLength));t.push(s(e.pageX));t.push(s(e.pageY));t.push(s(e.offsetX));t.push(s(e.offsetY));t.push(s(e.width));t.push(s(e.height));t.push(s(e.left));t.push(s(e.top));return t},loggerHandler:function(e,t,i,n){var a={},o=-1,r=[],s=$(this),g,h,m;a.id=t.id;a.type=t.type;a.timeStamp=e.timeStamp;a.eventType=e.type;a.width=s[0].offsetWidth;a.height=s[0].offsetHeight;try{m=t.type==="editor"?c.type==="baidueditor"?$(c.instance.iframe):$("#"+c.id):s;if(m.size()===0)m=s}catch(y){m=$("#"+c.id)}a.top=m.offset()["top"];a.left=m.offset()["left"];if(typeof e.pageX!=="undefined"){if(c.type==="baidueditor"){a.pageX=e.pageX+a.left;a.pageY=e.pageY+a.top;a.offsetX=e.pageX;a.offsetY=e.pageY}else{a.pageX=e.pageX;a.pageY=e.pageY;a.offsetX=e.pageX-a.left;a.offsetY=e.pageY-a.top}}if(e.type==="paste"){g=t.type==="editor"?c.type==="baidueditor"?s.find("body").text().length:s.val().length:s.val().length;f=true;l=function(e){f=false;a.pasteLength=e-g;if(a.pasteLength===0)return false;if(n.logSeq.length<d.limit){n.logSeq.push(n.formatLog(a))}else{return false}};return false}if(e.type==="input"){if(f===true){h=t.type==="editor"?c.type==="baidueditor"?s.find("body").text().length:s.val().length:s.val().length;l(h)}else{e.preventDefault()}}if(i===0){return false}if(i===-1){try{r=u(n.logSeq,function(e){return e[0]+"|"+e[1]+"|"+e[2]});o=p(r,t.id+"|"+t.type+"|"+e.type);if(o>-1){n.logSeq.splice(o,1)}}catch(v){}}if(n.logSeq.length<d.limit){n.logSeq.push(n.formatLog(a))}else{return false}}};var y=new m})(window);